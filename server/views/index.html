<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../public/index.css" />
    <title>undefined</title>
</head>
<body>
    
    <!-- Header -->
    <header>
        <div id="title">undefined</div>
    </header>
    <!-- End Header -->

    <!-- Login Section -->
    <section id="login">

    </section>
    <button onclick="onClickLoginButton()">로그인</button>
    <button onclick="onClickRegisterButton()">회원가입</button>

    <!-- End Login Section -->
    
        <div>3001</div>
    <!-- Board Section -->
    <section id="board">



        <div id="board-write">
            <button onClick=>글쓰기</button>
        </div>
    </section>
    <!-- End Board Section -->
        <tr onclick="test()">
            <td>123</td>
            <td>123</td>
            <td>123</td>
        </tr>


    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
        const header = document.querySelector("header");
        const board = document.querySelector("#board");
        const login = document.querySelector("#login");

        header.addEventListener("click", () => {
            location.href = "/";
        });


        const onClickLoginButton = () => {
            login.innerHTML = `
             <form>
                <input type="text" id="login_id" placeholder="id">
                <input type="password" id="login_password" placeholder="password">
                <button type="button" onclick="onSubmitLogin()">로그인</button>
                </form>`;

            console.log("login >> ", login);
        }

        const onClickRegisterButton = () => {
            login.innerHTML = `
             <form>
        <input type="text" id="register_nickname" placeholder="nickname">
        <input type="text" id="register_id" placeholder="id">
        <input type="password" id="register_password" placeholder="password">
                <button type="button" onclick="onSubmitRegister()">회원가입</button>


    </form>`;
        }

        const onSubmitLogin = () => {
            const id = document.querySelector("#login_id").value;
            const password = document.querySelector("#login_password").value;
            console.log("login id ,password >> ", id, password);
            const payload = { id, password };
            axios.post("/api/user/login", payload)
                .then(({data}) => {
                    console.log(data);
                })
                .catch((err) => {
                    console.error(err);
                })
        }

        const onSubmitRegister = () => {
            const nickname = document.querySelector("#register_nickname").value;
            const id = document.querySelector("#register_id").value;
            const password = document.querySelector("#register_password").value;
            console.log("login nickname, id ,password >> ", nickname, id, password);
            const payload = { nickname, id, password };
            console.log(paylaod);
            axios.post("/api/user/register", payload)
                .then(({data}) => {
                    console.log(data);
                })
                .catch((err) => {
                    console.error(err);
                })
        }

        const onClickDetailPage = (e) => {
            const target = e.querySelector("#hidden").innerText;
            console.log("target >> ", target);
            const payload = {
                _id: target,
            };

            axios.post("/api/board/detail", payload)
                .then(({data}) => {
                    console.log(data);
                })
                .catch((err) => {
                    console.error(err);
                })
        };

        const init = () => {
            axios
                .post("/api/board/getAll")
                .then((res) => {
                    const data = res.data;
                    console.log("data >> ", data);
                    let html = "<Table>";
                    data.board.map((v) => {
                        html += `
                                <tr onclick="onClickDetailPage(this)">
                                    <td id="hidden">${v._id}</td>
                                    <td class="board-title">${v.title}</td>
                                    <td>${v.createdAt}</td>
                                 </tr>
                                `;
                    });
                    html += "</Table>";
                    board.innerHTML = html;
                })
                .catch((err) => {
                    console.error(err);
                });
        };

        init();

    </script>
</body>
</html>
